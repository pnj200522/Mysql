EMP 테이블에서 MGR컬럼을 이용해서 직속 상관들을 나타냄


SELECT ENAME, EMPNO, MGR
FROM EMP
START WITH EMPNO = 7839     //어디 부터 시작하는지에 대한 절
CONNECT BY MGR = EMPNO;     //MGR과 EMPNO를 비교

##계층 쿼리를 레벨이 낮을 수록 안으로 들어가게끔 만들기(정렬하기)
SELECT LPAD(ENAME, LENGTH(ENAME) + LEVEL, ' ') NAME, LEVEL, EMPNO, MGR
--, (SELECT ENAME FROM EMP WHERE EMPNO = E.MGR) M_NAME   --, PRIOR ENAME M_NAME
FROM EMP E
START WITH EMPNO = 7839
CONNECT BY PRIOR EMPNO = MGR;

##정렬하는데 이름순으로 한번 더 정렬(ORDER SIBLINGS BY)
SELECT LPAD(ENAME, LENGTH(ENAME) + LEVEL, ' ') NAME, LEVEL, EMPNO, MGR
, PRIOR ENAME M_NAME
FROM EMP 
START WITH EMPNO = 7839
CONNECT BY PRIOR EMPNO = MGR
ORDER SIBLINGS BY ENAME;

##이름 나열 (SYS_CONNECT_BY_PATH)
SELECT LPAD(ENAME, LENGTH(ENAME) + LEVEL, '  ') NAME, SYS_CONNECT_BY_PATH(ENAME, '/') AS PATH
FROM EMP 
START WITH EMPNO = 7839
CONNECT BY PRIOR EMPNO = MGR;

##최상위 급여와 현재 레벨 급여의 차이(CONNECT_BY_ROOT SAL)
SELECT LPAD(ENAME, LENGTH(ENAME) + LEVEL, '  ') NAME
, LEVEL, EMPNO, MGR, SAL
, CONNECT_BY_ROOT SAL - SAL AS DIFF
FROM EMP 
START WITH EMPNO = 7839
CONNECT BY PRIOR EMPNO = MGR;

